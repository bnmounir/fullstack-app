(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){e.exports=a.p+"static/media/profile-image.5f5f881d.png"},35:function(e,t,a){e.exports=a.p+"static/media/logo1.7f512b04.png"},42:function(e,t,a){e.exports=a(77)},47:function(e,t,a){},77:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(32),c=a.n(s),o=(a(47),a(6)),i=a(12),l="SET_CURRENT_USER",u={isAuthenticated:!1,user:{}},m=a(23),p=a(40),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_MESSAGES":return Object(p.a)(t.messages);case"REMOVE_MESSAGE":return e.filter(function(e){return e._id!==t.id});default:return e}},g=Object(i.c)({currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return{isAuthenticated:Object.keys(t.user).length,user:t.user};default:return e}},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ERROR":return Object(m.a)({},e,{message:t.error});case"REMOVE_ERROR":return Object(m.a)({},e,{message:null});default:return e}},messages:h}),d=a(34);var f=a(80),E=a(7),v=a(8),b=a(10),O=a(9),j=a(11),w=a(78),y=a(41),N=a(19),U=a.n(N);function S(e,t,a){return new Promise(function(n,r){return U.a[e.toLowerCase()](t,a).then(function(e){return n(e.data)}).catch(function(e){return r(e.response.data.error)})})}var _=function(e){return{type:"ADD_ERROR",error:e}},x=function(){return{type:"REMOVE_ERROR"}};function A(e){return{type:l,user:e}}function k(e){!function(e){e?U.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete U.a.defaults.headers.common.Authorization}(e)}var M=a(35),C=a.n(M),R=a(15),I=a.n(R),T=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).logout=function(e){e.preventDefault(),a.props.logout()},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand"},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"navbar-header display-inline"},this.props.currentUser.isAuthenticated?r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("img",{style:{marginLeft:"20px",width:"50px",height:"50px"},className:"img-thumbnail",src:this.props.currentUser.user.profileImageUrl||I.a,alt:this.props.currentUser.user.username}),r.a.createElement("h5",{style:{display:"inline",margin:"3px"}},"Sign in as: ",this.props.currentUser.user.username)):r.a.createElement(w.a,{to:"/",className:"navbar-brand"},r.a.createElement("img",{src:C.a,alt:"Home"}))),this.props.currentUser.isAuthenticated?r.a.createElement("ul",{className:"nav navbar-nav navbar-right"},r.a.createElement("li",null,r.a.createElement(w.a,{to:"/users/".concat(this.props.currentUser.user.id,"/messages/new")},"New Messages")),r.a.createElement("li",null,r.a.createElement(w.a,{to:"/",onClick:this.logout},"Log out"))):r.a.createElement("ul",{className:"nav navbar-nav navbar-right"},r.a.createElement("li",null,r.a.createElement(w.a,{to:"/signup"},"Sign up")),r.a.createElement("li",null,r.a.createElement(w.a,{to:"/signin"},"Sign in")))))}}]),t}(n.Component);var D=Object(o.b)(function(e){return{currentUser:e.currentUser,username:e.username}},{logout:function(){return function(e){localStorage.clear(),k(!1),e(A({}))}}})(T),L=a(82),W=a(79),V=a(81),G=a(36),B=a.n(G),F=function(e){var t=e.date,a=e.profileImageUrl,n=e.text,s=e.username,c=e.removeMessage,o=e.isCorrectUser;return r.a.createElement("div",null,r.a.createElement("li",{className:"list-group-item"},r.a.createElement("img",{src:a||I.a,alt:"profile",height:"100px",width:"100px",className:"timeline-image"}),r.a.createElement("div",{className:"message-area",style:{width:"90%"}},r.a.createElement(w.a,{to:"/"},s," \xa0"),r.a.createElement("span",{className:"text-muted"},r.a.createElement(B.a,{className:"text-muted",fromNow:!0},t)),r.a.createElement("p",null,n),o&&r.a.createElement("button",{type:"button",onClick:c,className:"btn btn-outline-danger btn-sm"},"DELETE"))))},X=function(e){function t(){return Object(E.a)(this,t),Object(b.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(j.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchMessages()}},{key:"render",value:function(){var e=this,t=this.props,a=t.messages,n=t.removeMessage,s=t.currentUser,c=a.map(function(t){return r.a.createElement(F,{key:t._id,date:t.createdAt,text:t.text,username:t.user.username,profileImageUrl:t.user.profileImageUrl,removeMessage:n.bind(e,t.user._id,t._id),isCorrectUser:s===t.user._id})});return r.a.createElement("div",{className:"row col-sm-9"},r.a.createElement("div",{className:"offset-1 col-sm-10"},r.a.createElement("ul",{className:"list-group",id:"messages"},c)))}}]),t}(n.Component);var J=Object(o.b)(function(e){return{messages:e.messages,currentUser:e.currentUser.user.id}},{fetchMessages:function(){return function(e){return S("GET","/api/messages").then(function(t){return e({type:"LOAD_MESSAGES",messages:t})}).catch(function(e){return _(e.message)})}},removeMessage:function(e,t){return function(a){return S("delete","/api/users/".concat(e,"/messages/").concat(t)).then(function(){return a({type:"REMOVE_MESSAGE",id:t})}).catch(function(e){return _(e.message)})}}})(X);function P(e){e.profileImageUrl,e.username;return r.a.createElement("aside",{className:"col-sm-2"})}var z=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement(P,{profileImageUrl:e.profileImageUrl,username:e.username}),r.a.createElement(J,null))};function H(e){var t=e.currentUser;return t.isAuthenticated?r.a.createElement(z,{profileImageUrl:t.user.profileImageUrl}):r.a.createElement("div",{className:"home-hero"},r.a.createElement("h1",{className:"ho"},"What's happening? Share with us."),r.a.createElement("h4",{className:"ho"},"Welcome to Middleman"),r.a.createElement(w.a,{to:"/signup",className:"btn btn-primary"},"Sign up here!"))}var $=a(14),q=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(O.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=a.props.signUp?"signup":"signin";a.props.onAuth(t,a.state).then(function(){a.props.history.push("/")})},a.handleChange=function(e){a.setState(Object($.a)({},e.target.name,e.target.value))},a.state={email:"",username:"",password:"",profileImageUrl:""},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.username,n=e.password,s=e.profileImageUrl,c=this.props,o=c.heading,i=c.buttonText,l=c.signUp,u=c.errors,m=c.history,p=c.removeError;return m.listen(function(){p()}),r.a.createElement("div",null,r.a.createElement("div",{className:"row justify-content-md-center text-center"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("h2",null,o),u.message&&r.a.createElement("div",{className:"alert alert-danger"},u.message),r.a.createElement("label",{htmlFor:"email"},"Email: "),r.a.createElement("input",{className:"form-control",type:"email",name:"email",id:"email",onChange:this.handleChange,value:t}),r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{className:"form-control",type:"password",name:"password",id:"password",onChange:this.handleChange,value:n}),l&&r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},"Username: "),r.a.createElement("input",{className:"form-control",type:"text",name:"username",id:"username",onChange:this.handleChange,value:a}),r.a.createElement("label",{htmlFor:"image-url"},"Image Url: "),r.a.createElement("input",{className:"form-control",type:"text",name:"profileImageUrl",id:"image-url",onChange:this.handleChange,value:s})),r.a.createElement("button",{className:"btn btn-primary btn-block btn-lg"},i)))))}}]),t}(n.Component);function K(e){var t=function(t){function a(){return Object(E.a)(this,a),Object(b.a)(this,Object(O.a)(a).apply(this,arguments))}return Object(j.a)(a,t),Object(v.a)(a,[{key:"componentWillMount",value:function(){!1===this.props.isAuthenticated&&this.props.history.push("/signin")}},{key:"componentWillUpdate",value:function(e){!1===e.isAuthenticated&&this.props.history.push("/signin")}},{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),a}(n.Component);return Object(o.b)(function(e){return{isAuthenticated:e.currentUser.isAuthenticated}},null)(t)}var Q=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(b.a)(this,Object(O.a)(t).call(this,e))).handleNewMessage=function(e){e.preventDefault(),a.props.postNewMessage(a.state.message),a.setState({message:""}),a.props.history.push("/")},a.state={message:""},a}return Object(j.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement("form",{onSubmit:this.handleNewMessage},this.props.errors.message&&r.a.createElement("div",{className:"alert alert-danger"},this.props.errors),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})}}),r.a.createElement("button",{type:"submit",className:"btn btn-success pull-right"},"Add my message!")))}}]),t}(n.Component);var Y=Object(o.b)(function(e){return{errors:e.errors}},{postNewMessage:function(e){return function(t,a){var n=a().currentUser.user.id;return S("post","/api/users/".concat(n,"/messages"),{text:e}).then(function(e){}).catch(function(e){return t(_(e.message))})}}})(Q);var Z=Object(V.a)(Object(o.b)(function(e){return{currentUser:e.currentUser,errors:e.errors}},{authUser:function(e,t){return function(a){return new Promise(function(n,r){return S("post","/api/auth/".concat(e),t).then(function(e){var t=e.token,r=Object(y.a)(e,["token"]);localStorage.setItem("jwtToken",t),k(t),a(A(r)),a(x()),n()}).catch(function(e){a(_(e.message)),r()})})}},removeError:x})(function(e){var t=e.authUser,a=e.errors,n=e.removeError,s=e.currentUser;return r.a.createElement(L.a,null,r.a.createElement(W.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(H,Object.assign({currentUser:s},e))}}),r.a.createElement(W.a,{exact:!0,path:"/signin",render:function(e){return r.a.createElement(q,Object.assign({removeError:n,errors:a,onAuth:t,buttonText:"Sign in",heading:"Welcome Back"},e))}}),r.a.createElement(W.a,{exact:!0,path:"/signup",render:function(e){return r.a.createElement(q,Object.assign({removeError:n,errors:a,onAuth:t,signUp:!0,buttonText:"Sign up",heading:"Join us Today!"},e))}}),r.a.createElement(W.a,{path:"/users/:id/messages/new",component:K(Y)}))})),ee=a(39),te=a.n(ee),ae=Object(i.e)(g,Object(i.d)(Object(i.a)(d.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e}));if(localStorage.jwtToken){k(localStorage.jwtToken);try{ae.dispatch(A(te()(localStorage.jwtToken)))}catch(re){ae.dispatch(A({}))}}var ne=function(){return r.a.createElement(o.a,{store:ae},r.a.createElement(f.a,null,r.a.createElement("div",{className:"onboarding"},r.a.createElement(D,null),r.a.createElement(Z,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[42,2,1]]]);
//# sourceMappingURL=main.abbb12b2.chunk.js.map